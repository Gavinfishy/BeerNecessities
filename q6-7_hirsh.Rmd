
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
beers <- read.csv("beer_profile_and_ratings.csv")
beers
```
6. Which Brewery has the highest rated beers?
```{r}
highest_rated_by_brewery <- function(name) {
  return (beers %>% 
  group_by(Brewery) %>% 
  summarize(
   rating = mean({{name}})
  ) %>%
  arrange(desc(rating)) %>%
  slice(1:10))
}

bar_graph <- function(df) {
  return ({{df}} %>%
    mutate(Brewery = factor(Brewery, levels = unique(Brewery))) %>%
    ggplot( aes(x=Brewery, y=rating)) +
    geom_bar(stat="identity") +
    coord_cartesian(ylim = c(min({{df}}$rating), max({{df}}$rating))) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
  )
}

overall <- highest_rated_by_brewery(review_overall)
bar_graph(overall)
```



7. How does the IBU score affect the overall score?
```{r}
ggplot(beers, aes(x = Min.IBU, y = review_overall, color = factor(Min.IBU))) +
  geom_point(size = 3, alpha = 0.7)
```

