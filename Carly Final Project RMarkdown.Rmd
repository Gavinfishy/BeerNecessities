---
title: "Carly's RMarkdown"
output: html_document
date: "2023-11-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load in the data!
data <- read.csv("./beer_profile_and_ratings.csv")
```

### Question 1: How does the Alcohol content of the beer affect its overall rating?

#### Summary Statistics
```{r}
summary(data$ABV)
```

```{r}
#Max ABV beer
max_abv <- max(data$ABV, na.rm = TRUE)
beer_with_max_abv <- data[data$ABV == max_abv, ]
beer_with_max_abv
```


- The minimum ABV in the data set was 0, meaning non-alcoholic beers were present.
- The 1st quartile was 5.0% ABV, meaning that 25% of beers have an ABV of 5.0% or less.
- The median was 6.0% ABV.
- The mean was 6.53% AVV.
- The 3rd quartile was at 7.6% ABV, meaning 75% of the beers have an ABV of 7.6% or less.
- The max ABV was 57.5% from the beer 'SchorschbrÃ¤u Schorschbock 57%'.


```{r}
cor(data$ABV, data$review_overall, use = "complete.obs")
```

The correlation coefficient between ABV and overall rating is 0.251. This indicates a weak positive relationship between alcohol content and the overall rating. As the ABV increases, there will be a slight tendency for the overall rating to increase as well, but the relationship is not strong.


#### Plots
```{r}
#Histogram for ABV Distribution
hist(data$ABV, main="Distribution of Alcohol By Volume (ABV)", 
     xlab="ABV (%)", ylab="Frequency", col="blue", breaks=30)

# Histogram for Overall Ratings Distribution
hist(data$review_overall, main="Distribution of Overall Ratings", 
     xlab="Overall Rating", ylab="Frequency", col="green", breaks=30)

# Scatter Plot
plot(data$ABV, data$review_overall, main="Scatter Plot of ABV vs Overall Ratings",
     xlab="Alcohol By Volume (ABV) %", ylab="Overall Rating", pch=19, col=rgb(0,0,1,0.4))

```

Interpretation of ABV vs Overall Rating - The scatter plot indicates that there is very little to no evidence to suggest a clear-cut influence of alcohol content on beer ratings. Other characteristics are likely more indicative of the overall ratings of the beer. 


### Question 2: Can we predict the rating of a beer based on its characteristics?

#### Linear Regression Model
```{r}
library(caret)

# Selecting Characteristics
features <- data[, c("Sweet", "Sour", "Salty", "Fruits", "Hoppy", "Spices", "Malty", "review_overall")]

# Split data into training and testing sets
set.seed(123)
training_rows <- createDataPartition(features$review_overall, p = 0.8, list = FALSE)
train_data <- features[training_rows, ]
test_data <- features[-training_rows, ]

# Linear Model
model <- lm(review_overall ~ Sweet + Sour + Salty + Fruits + Hoppy + Spices + Malty, data = train_data)

# Summarize Model
summary(model)

# Make predictions on the test set
predictions <- predict(model, test_data)

# Calculate Root Mean Squared Error
rmse <- sqrt(mean((predictions - test_data$review_overall)^2))
print(paste("Root Mean Squared Error:", rmse))
```

### Interpretation of Linear Regression Statistics:
All of the categories had an extremely low p-value (<0.05) which means that all of the characteristics are statistical significant when predicting the overall rating.

- 1. Malty (0.0038272): This characteristic has the highest positive influence on the overall ratings. Beers with higher malty flavors are more likely to be rated higher, suggesting a strong preference for maltiness.

- 2. Fruits (0.0035599): Fruitiness is also a significant predictor. Beers that have a fruity character are generally rated more favorably.

- 3. Spices (0.0019652): Spiciness is the third most influential factor. A greater presence of spices in beer is associated with higher ratings.

- 4. Sour (0.0018759): Sourness has a positive influence on beer ratings. This suggests that beers with higher levels of sourness tend to be rated slightly more favorably.

- 5. Hoppy (0.0011240): Hoppiness has a positive influence. Beers with pronounced hop flavors tend to receive better ratings.

- 6. Sweet (-0.0016295): Sweetness shows a negative impact on ratings. Beers that are perceived as too sweet tend to be rated lower, indicating a possible aversion to excessive sweetness.

- 7. Salty (-0.0100856): Saltiness has the smallest absolute coefficient and negatively impacts ratings. This suggests that salty beers are less preferred by consumers.

I have decided to dive deeper into three of the categories to get a better understanding of how they affect beer ratings. I am choosing 'Malty', 'Fruits', and 'Spices' as my characteristics to investigate further because they have the highest affect on overall ratings.

### Malty

#### Summary Statistics
```{r}
malty <- summary(data$Malty)
malty
```

#### Plots
```{r}
ggplot(data, aes(x = Malty, y = review_overall)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "blue") +
  labs(title = "Relationship Between Malty Scores and Overall Ratings",
       x = "Malty Score",
       y = "Overall Rating")
```

#### Predicting Example
```{r}
# Linear regression with malty as the predictor
malty_regression <- lm(review_overall ~ Malty, data = data)

# Predicting the rating for a beer with a malty score of 200 (very high)
predicted_rating_malty <- predict(malty_regression, newdata = data.frame(Malty = 200))
predicted_rating_malty

#Predicting the rating for a beer with a malty score of 30 (very low).
predicted_rating_malty_2 <- predict(malty_regression, newdata = data.frame(Malty = 30))
predicted_rating_malty_2
```

### Fruits

#### Summary Statistis
```{r}
fruits_stats <- summary(data$Fruits)
fruits_stats
```

#### Plots
```{r}
ggplot(data, aes(x = Fruits, y = review_overall)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Relationship Between Fruit Scores and Overall Ratings",
       x = "Fruit Score",
       y = "Overall Rating")

```

#### Predicting Example
```{r}
# Linear regression with fruit as the predictor
fruits_regression <- lm(review_overall ~ Fruits, data = data)

# Predicting the rating for a beer with a fruit score of 110 (high)
predicted_rating_fruits <- predict(fruits_regression, newdata = data.frame(Fruits = 110))
predicted_rating_fruits

# Predicting the rating for a beer with a fruit score of 3 (low)
predicted_rating_fruits_2 <- predict(fruits_regression, newdata = data.frame(Fruits = 3))
predicted_rating_fruits_2

```


### Spices

#### Summary Statistics
```{r}
spices_stats <- summary(data$Spices)
spices_stats
```

#### Plots
```{r}
ggplot(data, aes(x = Spices, y = review_overall)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "green") +
  labs(title = "Relationship Between Spices Scores and Overall Ratings",
       x = "Spices Score",
       y = "Overall Rating")
```

#### Predicting Example
```{r}
# Linear regression with spices as the predictor
spices_regression <- lm(review_overall ~ Spices, data = data)

# Predicting the rating for a beer with a spices score of 120 (high)
predicted_rating_spices <- predict(spices_regression, newdata = data.frame(Spices = 120))
predicted_rating_spices

# Predicting the rating for a beer with a spices score of 3 (low)
predicted_rating_spices_2 <- predict(spices_regression, newdata = data.frame(Spices = 3))
predicted_rating_spices_2

```

