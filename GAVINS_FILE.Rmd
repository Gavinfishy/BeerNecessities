---
title: 'The Beer Necessities - Gavins Questions'
author: "Gavin Fisher"
date: "11/30/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

What are the most popular beer styles?
```{r}
library(dplyr)
data <- read.csv("beer_profile_and_ratings.csv")

beer_ratings <- data %>%
  group_by(Style) %>%
  summarise(Avg_Review = mean(review_overall, na.rm = TRUE))

highest_rated_style <- beer_ratings[which.max(beer_ratings$Avg_Review), ]
print(highest_rated_style)
```

```{r}
top_3_styles <- beer_ratings %>%
  arrange(desc(Avg_Review)) %>%
  head(3)

print(top_3_styles)
```



Can we recommend other beers if someone picks a beer they like?


```{r}

normalize <- function(x) {
  return ((x - min(x)) / (max(x) - min(x)))
}

selected_columns <- c('Sweet', 'Sour', 'Salty', 'Bitter')

beer_data_norm <- as.data.frame(lapply(data[, selected_columns], normalize))

user_beer_row <- which(data$`Name` == "Oatmeal Stout")

if(length(user_beer_row) == 0) {
  print("The beer 'Long Trail Ale' does not exist in the data.")
} else {
  user_beer <- beer_data_norm[user_beer_row, ]

  beer_data_norm <- beer_data_norm[-user_beer_row, ]

  dist_matrix <- as.matrix(dist(rbind(user_beer, beer_data_norm), method = "euclidean"))
  dist_vector <- as.vector(dist_matrix[1, -1])
  closest_beers <- order(dist_vector)[1:5]
  print(closest_beers)

  recommended_beers <- data[closest_beers, ]
  print(recommended_beers)
}
```

```{r}
# Load necessary libraries
library(FNN)
library(ggplot2)

# Perform PCA
pca <- prcomp(beer_data_norm, center = TRUE, scale. = TRUE)

# Get the coordinates of the data points in the first two principal components
pca_coords <- as.data.frame(pca$x[, 1:2])

# Use k-NN to find the 5 most similar beers
knn <- get.knn(pca_coords, k = 5)

# Add a column to indicate whether each beer is one of the nearest neighbors
pca_coords$Neighbor <- ifelse(row.names(pca_coords) %in% row.names(knn$nn.index), "Yes", "No")

# Plot the data points
ggplot(pca_coords, aes(x = PC1, y = PC2, color = Neighbor)) +
  geom_point() +
  theme_minimal()

```














